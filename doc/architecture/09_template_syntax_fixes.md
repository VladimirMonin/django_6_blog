# üêõ –ë–∞–≥–∏ —Å –¥–µ—Ñ–∏—Å–∞–º–∏: Django Template Syntax

> –¢—Ä–∏ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å–æ–≤ –æ—Ç–ª–∞–¥–∫–∏

**–ö–æ–º–º–∏—Ç—ã:**

- `ac6bd67` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å –¥–µ—Ñ–∏—Å–∞–º–∏ –≤ Django —à–∞–±–ª–æ–Ω–∞—Ö
- `9a138e5` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ —Å –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–æ–π (total_pages - 2)

---

## üìå –ü—Ä–æ–±–ª–µ–º–∞: TemplateSyntaxError

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—É—á–∞–ª–∏:

```python
django.template.exceptions.TemplateSyntaxError: 
Invalid character ('-') in variable name: '-'
```

**–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –û—à–∏–±–∫–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ —à–∞–±–ª–æ–Ω–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

---

## üîç –ë–∞–≥ #1: –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ —Å –¥–µ—Ñ–∏—Å–æ–º

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥

–í `button.html` –∏ `alert.html`:

```django-html
{# ‚ùå –û–®–ò–ë–ö–ê: Django –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å bi-{{ icon }} –∫–∞–∫ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ #}
<i class="bi bi-{{ icon }}"></i>
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –æ—à–∏–±–∫–∞?

Django Template Engine –≤–∏–¥–∏—Ç:

1. `bi` ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç
2. `bi-` ‚Äî –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è?
3. `{{ icon }}` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
4. **–ü–∞–Ω–∏–∫–∞**: `bi-` –Ω–µ –≤–∞–ª–∏–¥–Ω–æ–µ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π!

```mermaid
graph LR
    A[bi bi-{{ icon }}] --> B{–ü–∞—Ä—Å–∏–Ω–≥}
    B --> C[bi - OK]
    B --> D[bi- ??? –û–®–ò–ë–ö–ê]
    D --> E[TemplateSyntaxError]
```

### –†–µ—à–µ–Ω–∏–µ: –§–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –≤ Python

**1. –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ (`button.py`):**

```python
def get_template_data(self, args, kwargs, slots, context):
    icon = kwargs.get("icon")
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ü–û–õ–ù–´–ô –∫–ª–∞—Å—Å
    icon_class = f"bi bi-{icon}" if icon else None
    
    return {
        "text": kwargs.get("text"),
        "icon_class": icon_class,  # ‚Üê –ì–æ—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞
    }
```

**2. –í —à–∞–±–ª–æ–Ω–µ (`button.html`):**

```django-html
{# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—É—é —Å—Ç—Ä–æ–∫—É #}
{% if icon_class %}
    <i class="{{ icon_class }}"></i>
{% endif %}
```

---

## üîç –ë–∞–≥ #2: –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –≤ —É—Å–ª–æ–≤–∏—è—Ö

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥

–í `paginator.html`:

```django-html
{# ‚ùå –û–®–ò–ë–ö–ê: –æ–ø–µ—Ä–∞—Ç–æ—Ä `-` –≤–Ω—É—Ç—Ä–∏ if —Å –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–º `and` #}
{% if total_pages > 5 and current_page < total_pages - 2 %}
    <li>...</li>
{% endif %}
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –æ—à–∏–±–∫–∞?

Django Template Engine **–Ω–µ —É–º–µ–µ—Ç** –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫—É –≤–Ω—É—Ç—Ä–∏ `{% if %}` —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏!

```python
# Python –º–æ–∂–µ—Ç:
if total_pages > 5 and current_page < total_pages - 2:
    ...

# Django Template –ù–ï –º–æ–∂–µ—Ç:
{% if total_pages > 5 and current_page < total_pages - 2 %}
```

**–û—à–∏–±–∫–∞**: Django –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å `total_pages - 2` –∫–∞–∫ —Ç—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–∞:

1. `total_pages` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
2. `-` ‚Äî –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä
3. `2` ‚Äî —á–∏—Å–ª–æ

### –†–µ—à–µ–Ω–∏–µ 1: –§–∏–ª—å—Ç—Ä `add`

```django-html
{# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∏–ª—å—Ç—Ä add —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º #}
{% if total_pages > 5 %}
    {% if current_page < total_pages|add:"-2" %}
        <li>...</li>
    {% endif %}
{% endif %}
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `|add:"-2"`:**

```python
# –≠—Ç–æ –≤—ã—á–∏—Ç–∞–Ω–∏–µ!
total_pages|add:"-2"  ==  total_pages + (-2)  ==  total_pages - 2
```

### –†–µ—à–µ–Ω–∏–µ 2: –í—ã—á–∏—Å–ª–∏—Ç—å –≤ Python

```python
# –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
def get_template_data(self, args, kwargs, slots, context):
    total_pages = page_obj.paginator.num_pages
    show_ellipsis = (total_pages > 5 and 
                     current_page < total_pages - 2)
    
    return {
        "total_pages": total_pages,
        "show_ellipsis": show_ellipsis,  # ‚Üê –ì–æ—Ç–æ–≤–æ–µ –±—É–ª–µ–≤–æ
    }
```

```django-html
{# –í —à–∞–±–ª–æ–Ω–µ #}
{% if show_ellipsis %}
    <li>...</li>
{% endif %}
```

---

## üîç –ë–∞–≥ #3: HTMX –∞—Ç—Ä–∏–±—É—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ç–µ–≥–æ–≤

### –ü—Ä–æ–±–ª–µ–º–Ω—ã–π –∫–æ–¥ (–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π)

```django-html
{# ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–ê–Ø –û–®–ò–ë–ö–ê #}
<ul class="pagination" id="paginator-nav" hx-swap-oob="true">
    {% for page_num in page_range %}
        <li>{{ page_num }}</li>
    {% endfor %}
</ul>
```

**–ü—Ä–æ–±–ª–µ–º–∞**: HTMX –∞—Ç—Ä–∏–±—É—Ç—ã (`hx-swap-oob`) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ `<ul>`, –Ω–æ —ç—Ç–æ—Ç —Ç–µ–≥ –≤–Ω—É—Ç—Ä–∏ —Ü–∏–∫–ª–∞ Django.

Django –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å `hx-swap-oob` –∫–∞–∫ —á–∞—Å—Ç—å template-–≤—ã—Ä–∞–∂–µ–Ω–∏—è, –µ—Å–ª–∏ —Ä—è–¥–æ–º –µ—Å—Ç—å –¥—Ä—É–≥–∏–µ —Ç–µ–≥–∏.

### –†–µ—à–µ–Ω–∏–µ: –ê—Ç—Ä–∏–±—É—Ç—ã –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ

```django-html
{# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: hx-swap-oob –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º <nav> #}
<nav id="paginator-nav" hx-swap-oob="true">
    <ul class="pagination">
        {% for page_num in page_range %}
            <li>{{ page_num }}</li>
        {% endfor %}
    </ul>
</nav>
```

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

### –ë–∞–≥ #1: –ö–ª–∞—Å—Å—ã –∏–∫–æ–Ω–æ–∫

| –ü–æ–¥—Ö–æ–¥ | –ö–æ–¥ | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----|----------|
| ‚ùå –í —à–∞–±–ª–æ–Ω–µ | `class="bi bi-{{ icon }}"` | TemplateSyntaxError |
| ‚úÖ –í Python | `icon_class = f"bi bi-{icon}"` | –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º |

### –ë–∞–≥ #2: –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞

| –ü–æ–¥—Ö–æ–¥ | –ö–æ–¥ | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|-----|----------|
| ‚ùå –ú–∏–Ω—É—Å –≤ if | `{% if x < y - 2 %}` | TemplateSyntaxError |
| ‚úÖ –§–∏–ª—å—Ç—Ä add | `{% if x < y\|add:"-2" %}` | –†–∞–±–æ—Ç–∞–µ—Ç |
| ‚úÖ –í Python | `show = x < y - 2` | –õ—É—á—à–µ –≤—Å–µ–≥–æ |

---

## üîß –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–ª–∞–¥–∫–∏

### –®–∞–≥ 1: –ù–∞—Ö–æ–¥–∏–º –æ—à–∏–±–∫—É

```python
django.template.exceptions.TemplateSyntaxError: 
Invalid character ('-') in variable name: '-'
  File ".../button/button.html", line 3, in <module>
    <i class="bi bi-{{ icon }}"></i>
```

**Traceback** —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `button.html:3`.

### –®–∞–≥ 2: –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –º–µ—Å—Ç —Å –¥–µ—Ñ–∏—Å–∞–º–∏

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `grep` –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:

```bash
# –ü–æ–∏—Å–∫ bi-{{ –≤ —à–∞–±–ª–æ–Ω–∞—Ö
grep -r "bi-{{" templates/ blog/components/
```

**–ù–∞–π–¥–µ–Ω–æ 3 –º–µ—Å—Ç–∞:**

1. `button/button.html` ‚Äî `bi-{{ icon }}`
2. `alert/alert.html` ‚Äî `bi-{{ icon }}`
3. `paginator/paginator.html` ‚Äî `total_pages - 2`

### –®–∞–≥ 3: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ –æ–¥–Ω–æ–º—É

```mermaid
graph TD
    A[button.html] --> B[–ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ Python]
    C[alert.html] --> B
    D[paginator.html] --> E[–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å add filter]
    B --> F[–¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã]
    E --> F
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä–∏–ª–∏ **–≤—Å–µ** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –Ω–∞ –ø–æ—Ö–æ–∂–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—Ä–æ–±–ª–µ–º–∞ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
|-----------|----------|------------|
| Button | `bi-{{ icon }}` | ‚úÖ |
| Alert | `bi-{{ icon }}` | ‚úÖ |
| PostCard | –ù–µ—Ç | ‚úÖ |
| Paginator | `total_pages - 2` | ‚úÖ |

---

## üéì –£—Ä–æ–∫–∏ –∏ Best Practices

### 1. –ò–∑–±–µ–≥–∞–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ –≤ —à–∞–±–ª–æ–Ω–∞—Ö

```django-html
{# ‚ùå –ü–õ–û–•–û - –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å –¥–µ—Ñ–∏—Å–æ–º #}
<div class="prefix-{{ value }}"></div>

{# ‚úÖ –•–û–†–û–®–û - —Ñ–æ—Ä–º–∏—Ä—É–π –≤ Python #}
<div class="{{ full_class }}"></div>
```

### 2. –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –≤ Python, –Ω–µ –≤ —à–∞–±–ª–æ–Ω–∞—Ö

```python
# ‚úÖ –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ/view
context = {
    "threshold": total_pages - 2,
    "is_large": total_pages > 10,
}
```

```django-html
{# ‚úÖ –í —à–∞–±–ª–æ–Ω–µ - —Ç–æ–ª—å–∫–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è #}
{% if current_page < threshold %}
{% if is_large %}
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏

```django-html
{# –î–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π #}
{{ value|add:"5" }}
{{ value|add:"-2" }}
{{ price|multiply:"1.2" }}  {# –ï—Å–ª–∏ –µ—Å—Ç—å —Ç–∞–∫–æ–π —Ñ–∏–ª—å—Ç—Ä #}
```

### 4. –õ–æ–≥–∏–∫–∞ –≤ Python, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤ —à–∞–±–ª–æ–Ω–∞—Ö

**–§–∏–ª–æ—Å–æ—Ñ–∏—è Django:**

> Templates should contain presentation logic, not business logic.

```python
# ‚úÖ –•–û–†–û–®–û - –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤ view/component
def get_template_data(...):
    return {
        "show_button": user.is_authenticated and user.has_perm('edit'),
        "button_text": "Edit" if is_owner else "View",
        "css_class": "btn-primary" if is_active else "btn-secondary",
    }
```

```django-html
{# ‚úÖ –®–∞–±–ª–æ–Ω —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç #}
{% if show_button %}
    <button class="{{ css_class }}">{{ button_text }}</button>
{% endif %}
```

---

## üêõ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —à–∞–±–ª–æ–Ω–æ–≤

–ü–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º –ø—Ä–æ–≤–µ—Ä—è–π:

- [ ] –ù–µ—Ç `class="prefix-{{ var }}"` —Å –¥–µ—Ñ–∏—Å–∞–º–∏
- [ ] –ù–µ—Ç –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏ –≤ `{% if %}` (`x - 2`, `y + 3`)
- [ ] HTMX –∞—Ç—Ä–∏–±—É—Ç—ã –Ω–∞ –∫–æ—Ä–Ω–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö
- [ ] –õ–æ–≥–∏–∫–∞ –≤ Python, —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ—Å—Ç—ã–µ
- [ ] –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä—ã (`|add`, `|default`) –≤–º–µ—Å—Ç–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–∞–≥–æ–≤

| –¢–∏–ø –±–∞–≥–∞ | –í—Ä–µ–º—è –æ—Ç–ª–∞–¥–∫–∏ | –°–ª–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|---------------|------------------------|
| `bi-{{ icon }}` | 30 –º–∏–Ω | –ù–∏–∑–∫–∞—è |
| `total_pages - 2` | 45 –º–∏–Ω | –°—Ä–µ–¥–Ω—è—è |
| `hx-swap-oob` | 15 –º–∏–Ω | –ù–∏–∑–∫–∞—è |
| **–ò—Ç–æ–≥–æ** | **1.5 —á–∞—Å–∞** | - |

**–í—ã–≤–æ–¥**: –ü—Ä–æ—Å—Ç—ã–µ –æ—à–∏–±–∫–∏, –Ω–æ —Ç—Ä—É–¥–Ω–æ –Ω–∞–π—Ç–∏ –±–µ–∑ traceback.

---

## üîó –ò—Ç–æ–≥–∏ —Å–µ—Ä–∏–∏

–ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏:

1. **[HTMX –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è](06_htmx_integration.md)** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏–∫–∏ –±–µ–∑ JavaScript
2. **[Components + HTMX + Partials](07_htmx_components_partials.md)** ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
3. **[Paginator –∫–æ–º–ø–æ–Ω–µ–Ω—Ç](08_paginator_component.md)** ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å –¥–≤—É–º—è —Ä–µ–∂–∏–º–∞–º–∏
4. **[–ë–∞–≥–∏ —Å –¥–µ—Ñ–∏—Å–∞–º–∏](09_template_syntax_fixes.md)** ‚Äî —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º Template Syntax

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

Phase 1.8 –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–ª–µ–¥—É—é—â–∞—è —Ñ–∞–∑–∞:

- Phase 2.0: Markdown –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- Phase 2.1: –°–∏—Å—Ç–µ–º–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 13 –¥–µ–∫–∞–±—Ä—è 2025
