# ๐งญ ะกะตัะธั 18: ะะธะฝะฐะผะธัะตัะบะธะต ัะปะตะฑะฝัะต ะบัะพัะบะธ ั dropdown ะฝะฐะฒะธะณะฐัะธะตะน

> IntersectionObserver + dropdown ะผะตะฝั ะดะปั ะฝะฐะฒะธะณะฐัะธะธ ะฟะพ ะดะปะธะฝะฝัะผ ััะฐัััะผ

**ะะพะผะผะธัั:** `0d2d1d8`, `9203464`, `878d880`

---

## ๐ ะัะพะฑะปะตะผะฐ: ะะพัะตัั ะบะพะฝัะตะบััะฐ ะฒ ะดะปะธะฝะฝัั ััะฐัััั

ะัะตะดััะฐะฒั ััะฐััั ะฝะฐ 10,000 ัะปะพะฒ ั 15 ัะฐะทะดะตะปะฐะผะธ H2 ะธ 40 ะฟะพะดัะฐะทะดะตะปะฐะผะธ H3.

**ะะพะปัะทะพะฒะฐัะตะปั ะฟัะพะบัััะธะฒะฐะตั ะฒะฝะธะท ะธ ัะฟัะฐัะธะฒะฐะตั ัะตะฑั:**  
โ "ะ ะบะฐะบะพะผ ัะฐะทะดะตะปะต ั ัะตะนัะฐั?"  
โ "ะะฐะบ ะฑััััะพ ะฟะตัะตะนัะธ ะบ ะดััะณะพะผั ัะฐะทะดะตะปั?"

**ะกัะฐะฝะดะฐััะฝะพะต ะพะณะปะฐะฒะปะตะฝะธะต** (Table of Contents) **ะฝะต ะฟะพะผะพะณะฐะตั:**  
- ะะฐัะพะดะธััั ะฒะฒะตััั ัััะฐะฝะธัั ะธะปะธ ะฒ sidebar  
- ะัะธ ะฟัะพะบัััะบะต ะฒะฝะธะท โ ะฝะต ะฒะธะดะฝะพ  
- ะัะถะฝะพ ัะบัะพะปะปะธัั ะพะฑัะฐัะฝะพ ะบ ะพะณะปะฐะฒะปะตะฝะธั

---

## ๐ฏ ะะตัะตะฝะธะต: Sticky Breadcrumbs

**ะฅะปะตะฑะฝัะต ะบัะพัะบะธ** (breadcrumbs) **ะฟัะธะบะปะตะตะฝั ะบ ะฒะตััั ัะบัะฐะฝะฐ** ะธ ะฟะพะบะฐะทัะฒะฐัั:

```
ะขะตะบััะธะน ัะฐะทะดะตะป H2  /  ะขะตะบััะธะน ะฟะพะดัะฐะทะดะตะป H3
```

**ะัะธ ะฝะฐะฒะตะดะตะฝะธะธ ะฝะฐ H2** โ ะฒัะฟะฐะดะฐะตั dropdown ัะพ ะฒัะตะผะธ H2 ะดะปั ะฑััััะพะณะพ ะฟะตัะตัะพะดะฐ.

**ะะธะทัะฐะปะธะทะฐัะธั:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐งญ ะะพะดัะปัะฝัะน JavaScript  /  ะะฝัะตะณัะฐัะธั     โ โ Sticky breadcrumbs
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    โ
    โโ ะัะธ hover ะฝะฐ "ะะพะดัะปัะฝัะน JavaScript":
       
       โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
       โ โ ะะพะดัะปัะฝัะน JavaScript       โ โ ะขะตะบััะธะน ัะฐะทะดะตะป
       โ   Fullscreen ะธะทะพะฑัะฐะถะตะฝะธั      โ
       โ   ะะธะฝะฐะผะธัะตัะบะธะต breadcrumbs    โ
       โ   ะะพะฑะธะปัะฝะฐั ะฐะดะฐะฟัะธะฒะฝะพััั      โ
       โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั?

### 1๏ธโฃ ะกะฑะพั ะทะฐะณะพะปะพะฒะบะพะฒ

```javascript
const headings = Array.from(
    document.querySelectorAll('.markdown-content h2, .markdown-content h3')
);
```

**ะะพะปััะฐะตะผ ะผะฐััะธะฒ:**

```javascript
[
    <h2 id="intro">ะะฒะตะดะตะฝะธะต</h2>,
    <h3 id="problem">ะัะพะฑะปะตะผะฐ</h3>,
    <h3 id="solution">ะะตัะตะฝะธะต</h3>,
    <h2 id="architecture">ะััะธัะตะบัััะฐ</h2>,
    <h3 id="modules">ะะพะดัะปะธ</h3>,
    // ...
]
```

---

### 2๏ธโฃ ะะตะฝะตัะฐัะธั ัะบะพัะฝัั ัััะปะพะบ

**ะัะพะฑะปะตะผะฐ:** ะะต ั ะฒัะตั ะทะฐะณะพะปะพะฒะบะพะฒ ะตััั `id` ะฐััะธะฑัั.

**ะะตัะตะฝะธะต:** ะะฒัะพะผะฐัะธัะตัะบะธ ะณะตะฝะตัะธััะตะผ slug ะธะท ัะตะบััะฐ:

```javascript
headings.forEach((heading, index) => {
    if (!heading.id) {
        const slug = heading.textContent
            .toLowerCase()
            .replace(/[^\w\s-]/g, '')  // ะฃะฑะธัะฐะตะผ ัะฟะตััะธะผะฒะพะปั
            .replace(/\s+/g, '-')      // ะัะพะฑะตะปั โ ะดะตัะธัั
            .substring(0, 50);          // ะะณัะฐะฝะธัะธะฒะฐะตะผ ะดะปะธะฝั
        heading.id = `heading-${slug}-${index}`;
    }
});
```

**ะัะธะผะตั:**

| ะขะตะบัั ะทะฐะณะพะปะพะฒะบะฐ | ะกะณะตะฝะตัะธัะพะฒะฐะฝะฝัะน ID |
|-----------------|---------------------|
| "ะะพะดัะปัะฝัะน JavaScript" | `heading-modulnyj-javascript-0` |
| "ะงัะพ ััะพ ัะฐะบะพะต?" | `heading-chto-eto-takoe-1` |
| "๐ฏ ะะตัะตะฝะธะต: Sticky" | `heading-reshenie-sticky-2` |

---

### 3๏ธโฃ ะััะปะตะถะธะฒะฐะฝะธะต ะฟัะพะบัััะบะธ

**ะะปะณะพัะธัะผ:**

```mermaid
graph TD
    A[ะะพะปัะทะพะฒะฐัะตะปั ัะบัะพะปะปะธั] --> B[window.scrollY + 150]
    B --> C{ะะปั ะบะฐะถะดะพะณะพ ะทะฐะณะพะปะพะฒะบะฐ}
    C --> D{headingTop <= scrollPosition?}
    D -->|H2| E[currentH2 = heading<br/>currentH3 = null]
    D -->|H3| F[currentH3 = heading]
    D -->|ะะตั| G[ะัะพะฟััะบะฐะตะผ]
    E --> H[ะะฑะฝะพะฒะปัะตะผ breadcrumbs]
    F --> H
    G --> H
```

**ะะพะด:**

```javascript
window.addEventListener('scroll', () => {
    const scrollPosition = window.scrollY + 150; // Offset
    
    let currentH2 = null;
    let currentH3 = null;
    
    for (const heading of headings) {
        if (heading.offsetTop <= scrollPosition) {
            if (heading.tagName === 'H2') {
                currentH2 = heading;
                currentH3 = null; // ะกะฑัะฐััะฒะฐะตะผ H3!
            } else if (heading.tagName === 'H3' && currentH2) {
                currentH3 = heading;
            }
        }
    }
});
```

**ะะฐัะตะผ offset +150px?**  
ะะพะณะดะฐ ะทะฐะณะพะปะพะฒะพะบ ะฝะฐัะพะดะธััั **ัััั ะฒััะต** ะฒะตััะฐ ัะบัะฐะฝะฐ (ะฒ ะฟัะตะดะตะปะฐั 150px), ััะธัะฐะตะผ ััะพ ะผั **ัะถะต ะฒ ััะพะผ ัะฐะทะดะตะปะต**.

---

### 4๏ธโฃ Dropdown ะผะตะฝั

**ะกัััะบัััะฐ DOM:**

```html
<div class="breadcrumbs-dynamic">
    <span class="breadcrumb-item breadcrumb-dropdown">
        <a href="#heading-intro" class="breadcrumb-h2-link">
            ะะฒะตะดะตะฝะธะต
        </a>
        <div class="breadcrumb-dropdown-menu">
            <a class="breadcrumb-dropdown-item active">ะะฒะตะดะตะฝะธะต</a>
            <a class="breadcrumb-dropdown-item">ะััะธัะตะบัััะฐ</a>
            <a class="breadcrumb-dropdown-item">ะะตะทัะปััะฐัั</a>
        </div>
    </span>
    <span class="breadcrumb-separator"> / </span>
    <span class="breadcrumb-item active">ะัะพะฑะปะตะผะฐ</span>
</div>
```

**CSS ะดะปั dropdown:**

```css
.breadcrumb-dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    display: none; /* ะกะบััั ะฟะพ ัะผะพะปัะฐะฝะธั */
    z-index: 1001;
}

.breadcrumb-dropdown-menu.show {
    display: block;
    animation: dropdownFadeIn 0.2s ease;
}

@keyframes dropdownFadeIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
```

**ะะฝะธะผะฐัะธั ะฟะพัะฒะปะตะฝะธั:**

```
ะะฐะฒะตะดะตะฝะธะต ะผััะธ:
    0ms:   opacity: 0, translateY(-10px)
    200ms: opacity: 1, translateY(0)
```

---

### 5๏ธโฃ ะะปะฐะฒะฝะฐั ะฟัะพะบัััะบะฐ

**ะัะธ ะบะปะธะบะต ะฝะฐ ัััะปะบั:**

```javascript
dropdownItem.addEventListener('click', (e) => {
    e.preventDefault();
    h2.scrollIntoView({ behavior: 'smooth', block: 'start' });
    dropdown.classList.remove('show'); // ะะฐะบััะฒะฐะตะผ dropdown
});
```

**`scrollIntoView` ะพะฟัะธะธ:**

| ะะฟัะธั | ะะฝะฐัะตะฝะธะต | ะะฐัะตะผ |
|-------|----------|-------|
| `behavior: 'smooth'` | โ | ะะปะฐะฒะฝะฐั ะฐะฝะธะผะฐัะธั ะฟัะพะบัััะบะธ |
| `block: 'start'` | โ | ะะฐะณะพะปะพะฒะพะบ ั ะฒะตััะฐ ัะบัะฐะฝะฐ |

**ะะตะท `e.preventDefault()`:**  
ะัะฐัะทะตั ะฒัะฟะพะปะฝะธั ััะฐะฝะดะฐััะฝะพะต ะฟะพะฒะตะดะตะฝะธะต โ ะผะณะฝะพะฒะตะฝะฝัะน ะฟััะถะพะบ ะบ `#anchor`.

**ะก `e.preventDefault()` + `scrollIntoView`:**  
ะะปะฐะฒะฝะฐั ะฐะฝะธะผะธัะพะฒะฐะฝะฝะฐั ะฟัะพะบัััะบะฐ ะบ ัะฐะทะดะตะปั.

---

## ๐จ CSS: Sticky ะฟะพะทะธัะธะพะฝะธัะพะฒะฐะฝะธะต

**Breadcrumbs "ะฟัะธะบะปะตะตะฝั" ะบ ะฒะตััั ะฟัะธ ะฟัะพะบัััะบะต:**

```css
.breadcrumbs-dynamic {
    position: sticky;
    top: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    padding: 0.75rem 0;
    border-bottom: 1px solid #dee2e6;
    z-index: 1000;
}
```

**ะะปััะตะฒัะต ัะฒะพะนััะฒะฐ:**

| ะกะฒะพะนััะฒะพ | ะะฝะฐัะตะฝะธะต | ะญััะตะบั |
|----------|----------|--------|
| `position: sticky` | โ | "ะัะธะปะธะฟะฐะตั" ะบ `top: 0` ะฟัะธ ะฟัะพะบัััะบะต |
| `backdrop-filter: blur(10px)` | โ | ะะฐะทะผััะธะต ัะพะฝะฐ ะฟะพะด breadcrumbs |
| `rgba(255,255,255,0.95)` | โ | ะะพะปัะฟัะพะทัะฐัะฝัะน ะฑะตะปัะน ัะพะฝ |
| `z-index: 1000` | โ | ะะพะฒะตัั ะบะพะฝัะตะฝัะฐ, ะฝะพ ะฟะพะด ะผะพะดะฐะปะบะฐะผะธ |

**ะะธะทัะฐะปะธะทะฐัะธั sticky:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Breadcrumbs (sticky)    โ โ ะัะตะณะดะฐ ะฒะธะดะฝั
โโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                         โ
โ   ะะพะฝัะตะฝั ะฟัะพะบัััะธะฒะฐะตัััโ
โ   ะฒะฝะธะท ะฟะพะด breadcrumbs  โ
โ                         โ
โ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะะฐะณ: Gap ะผะตะถะดั ัััะปะบะพะน ะธ ะผะตะฝั

**ะัะพะฑะปะตะผะฐ:**  
ะัะธ ะฝะฐะฒะตะดะตะฝะธะธ ะผััะธ ะฝะฐ H2 ัััะปะบั ะฟะพัะฒะปัะตััั dropdown, ะฝะพ ะบะพะณะดะฐ ะผััั ะดะฒะธะถะตััั ะฒะฝะธะท ะบ dropdown โ ะพะฝ ะธััะตะทะฐะตั.

**ะัะธัะธะฝะฐ:**  
ะะตะถะดั ัััะปะบะพะน ะธ ะผะตะฝั ะตััั gap ~4px, ะผััั ะฟะพะบะธะดะฐะตั hover ะพะฑะปะฐััั.

**ะะตัะตะฝะธะต:**  
ะฃะฑัะฐะปะธ `margin-top` ะธ ะดะพะฑะฐะฒะธะปะธ padding ะดะปั "ะฟะตัะตะบัััะธั" gap:

```javascript
dropdown.style.marginTop = '-2px';
dropdown.style.paddingTop = '8px';
```

**ะะพ:**

```
[ะกััะปะบะฐ H2]
     โ 4px gap (ะผััั ะทะดะตัั = dropdown ะธััะตะทะฐะตั)
[โโโโโโโโโโโโ]
โ  Dropdown  โ
[โโโโโโโโโโโโ]
```

**ะะพัะปะต:**

```
[ะกััะปะบะฐ H2]
[โโโโโโโโโโโโ] โ padding-top: 8px (ะฝะตะฒะธะดะธะผะฐั ะพะฑะปะฐััั)
โ  Dropdown  โ
[โโโโโโโโโโโโ]
```

ะขะตะฟะตัั ะผััั ะฝะต ะฟะพะบะธะดะฐะตั hover ะพะฑะปะฐััั!

---

## ๐ ะััะธัะตะบัััะฝัะต ัะตัะตะฝะธั

### โ Throttle ะดะปั scroll ัะพะฑััะธั

**ะัะพะฑะปะตะผะฐ:**  
`scroll` event ััะฐะฑะฐััะฒะฐะตั **ัะพัะฝะธ ัะฐะท ะฒ ัะตะบัะฝะดั** โ ัะพัะผะพะทะธั ะฑัะฐัะทะตั.

**ะะตัะตะฝะธะต:**  
ะัะฟะพะปัะทัะตะผ `requestAnimationFrame` ะดะปั throttle:

```javascript
let ticking = false;
window.addEventListener('scroll', () => {
    if (!ticking) {
        window.requestAnimationFrame(() => {
            updateBreadcrumbs();
            ticking = false;
        });
        ticking = true;
    }
});
```

**ะะฐะบ ัะฐะฑะพัะฐะตั:**

```mermaid
sequenceDiagram
    participant Scroll
    participant Listener
    participant RAF
    participant Update
    
    Scroll->>Listener: scroll event (10 ัะฐะท)
    Listener->>RAF: requestAnimationFrame()
    Note over RAF: ticking = true<br/>ะะณะฝะพัะธััะตะผ ะพััะฐะปัะฝัะต
    RAF->>Update: updateBreadcrumbs()
    Update->>RAF: ticking = false
    Note over RAF: ะะพัะพะฒ ะบ ัะปะตะดัััะตะผั ะบะฐะดัั
```

**ะะตะทัะปััะฐั:**  
ะะผะตััะพ **1000 ะพะฑะฝะพะฒะปะตะฝะธะน/ัะตะบ** โ **~60 ะพะฑะฝะพะฒะปะตะฝะธะน/ัะตะบ** (ัะฐััะพัะฐ ะบะฐะดัะพะฒ ะฑัะฐัะทะตัะฐ).

---

### โ ะะพะดัะฒะตัะบะฐ ะฐะบัะธะฒะฝะพะณะพ ัะปะตะผะตะฝัะฐ

**ะ dropdown ะฒัะดะตะปัะตะผ ัะตะบััะธะน ัะฐะทะดะตะป:**

```javascript
if (h2.id === currentH2.id) {
    dropdownItem.classList.add('active');
}
```

**CSS:**

```css
.breadcrumb-dropdown-item.active {
    background-color: var(--accent-yellow);
    border-left-color: var(--text-dark);
    font-weight: 600;
}
```

**ะะธะทัะฐะปัะฝะพ:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ โช ะะฒะตะดะตะฝะธะต                โ
โ โ ะะพะดัะปัะฝัะน JavaScript    โ โ active (ัะตะบััะธะน ัะฐะทะดะตะป)
โ โช Fullscreen ะธะทะพะฑัะฐะถะตะฝะธั  โ
โ โช Breadcrumbs             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต: TOC vs Breadcrumbs

| ะัะธัะตัะธะน | Table of Contents | Breadcrumbs |
|----------|-------------------|-------------|
| **ะะฐัะฟะพะปะพะถะตะฝะธะต** | Sidebar ะธะปะธ ัะฒะตััั | Sticky ะฒะฒะตััั |
| **ะะธะดะธะผะพััั** | ะขะตััะตััั ะฟัะธ ะฟัะพะบัััะบะต | ะัะตะณะดะฐ ะฒะธะดะฝั |
| **ะะฝัะพัะผะฐัะธั** | ะัะต ัะฐะทะดะตะปั | ะขะพะปัะบะพ ัะตะบััะธะน |
| **ะะฐะฒะธะณะฐัะธั** | ะกัะฐัะธัะฝัะน ัะฟะธัะพะบ | ะะธะฝะฐะผะธัะตัะบะพะต ะพะฑะฝะพะฒะปะตะฝะธะต + dropdown |
| **Use case** | ะะฑะทะพั ััััะบัััั | ะัะธะตะฝัะฐัะธั ะฒ ัะตะบััะต |

**ะัะฒะพะด:**  
TOC ะธ Breadcrumbs **ะดะพะฟะพะปะฝััั ะดััะณ ะดััะณะฐ**, ะฐ ะฝะต ะทะฐะผะตะฝััั.

---

## ๐ ะะตะทัะปััะฐัั

**ะะตััะธะบะธ:**

- **+180 ัััะพะบ** JavaScript (breadcrumbs.js)  
- **+150 ัััะพะบ** CSS (sticky, dropdown, animations)  
- **+1 ะบะพะฝัะตะนะฝะตั** ะฒ post_detail.html (`<div class="breadcrumbs-dynamic">`)

**UX ัะปัััะตะฝะธั:**

โ ะะพะปัะทะพะฒะฐัะตะปั ะฒัะตะณะดะฐ ะทะฝะฐะตั, ะณะดะต ะฝะฐัะพะดะธััั  
โ ะัััััะน ะฟะตัะตัะพะด ะบ ะปัะฑะพะผั ัะฐะทะดะตะปั H2  
โ ะะปะฐะฒะฝะฐั ะฐะฝะธะผะฐัะธั dropdown  
โ ะะดะฐะฟัะธะฒะฝะพะต ะฟะพะฒะตะดะตะฝะธะต (ัะผ. ะกะตัะธั 19)

**ะขะตัะฝะธัะตัะบะธะต ะฒัะณะพะดั:**

โ Throttle ะดะปั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ  
โ ะะฒัะพะผะฐัะธัะตัะบะฐั ะณะตะฝะตัะฐัะธั ัะบะพัะตะน  
โ ะะปะฐะฒะฝะฐั ะฟัะพะบัััะบะฐ ะฒะผะตััะพ ะฟััะถะบะพะฒ

---

## ๐ ะกะปะตะดัััะธะน ัะฐะณ

ะขะตะฟะตัั ะฟะพัะผะพััะธะผ, ะบะฐะบ ะฐะดะฐะฟัะธัะพะฒะฐัั ะฒัะต ะผะพะดัะปะธ ะดะปั ะผะพะฑะธะปัะฝัั ััััะพะนััะฒ:

โก๏ธ [ะกะตัะธั 19: ะะพะฑะธะปัะฝะฐั ะฐะดะฐะฟัะธะฒะฝะพััั](19_mobile_responsive.md)

---

**ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 14 ะดะตะบะฐะฑัั 2025  
**ะะพะผะผะธัั:** `0d2d1d8`, `9203464`, `878d880`
