# Фаза 4.13: Компонент результатов поиска

## Цель

Создать django-component для отображения результата поиска с подсветкой и метаданными.

---

## Контекст

Результат поиска — это не просто текст, а структурированная единица с:
- Контентом чанка (текст или код)
- "Хлебными крошками" контекста (Статья → Секция)
- Типом чанка (для визуального различия)
- Ссылкой на полную статью

Проект уже использует `django-components` (папка `blog/components/`). Компонент поиска следует тому же паттерну.

**Визуальное оформление:**
- CODE чанки — подсветка синтаксиса (Pygments или Highlight.js)
- TEXT чанки — обычный текст
- Цветовая индикация типа (badge)
- Компактный вид с возможностью "развернуть"

**Философия:** Компонент — переиспользуемый UI-блок.

**Документация:**
- [ИИ поиск на базе смыслов — концепция](../researches/report_6/ИИ%20поиск%20на%20базе%20смыслов%20-%20концепция.md) — "UX/UI паттерны: Code Highlighting"

---

## Задачи

### Создание структуры компонента

- [ ] Создать папку `blog/components/search_result/`
- [ ] Создать файлы: `search_result.py`, `search_result.html`, `search_result.css`

### Python-класс компонента

- [ ] Определить класс `SearchResult(Component)`
- [ ] Параметры: `chunk`, `score`, `show_context` (bool)
- [ ] Метод `get_context_data()` для подготовки данных

### HTML-шаблон

- [ ] Обёртка с классом для типа чанка (search-result--code, search-result--text)
- [ ] "Хлебные крошки": ссылка на пост → название секции
- [ ] Badge с типом чанка (CODE, TEXT, MERMAID)
- [ ] Контент чанка (с подсветкой для кода)
- [ ] Кнопка "Показать контекст" с HTMX-атрибутами

### Подсветка кода

- [ ] Для CODE-чанков использовать уже существующий механизм подсветки
- [ ] `code_language` определяет язык для Pygments/Highlight.js
- [ ] Если язык не указан — generic подсветка

### Стилизация

- [ ] CSS для разных типов чанков (фоновые цвета, иконки)
- [ ] Адаптивность для мобильных устройств
- [ ] Согласованность с общим стилем блога (чёрно-бело-жёлтый)

### Кнопка "Показать контекст"

- [ ] HTMX-атрибуты: `hx-get="/search/context/{chunk_id}/"`
- [ ] `hx-target` — вставка перед/после текущего чанка
- [ ] `hx-swap="outerHTML"` или `beforebegin`/`afterend`

### Регистрация компонента

- [ ] Добавить в `blog/components/__init__.py`
- [ ] Проверить, что компонент доступен в шаблонах

---

## Тестирование

- [ ] Отрендерить компонент с CODE-чанком — проверить подсветку
- [ ] Отрендерить компонент с TEXT-чанком — проверить стили
- [ ] Проверить отображение "хлебных крошек"
- [ ] Проверить работу ссылки на пост

---

## Коммит

```
phase 4.13 feat: Компонент результатов поиска
- Создан компонент search_result в blog/components/
- Реализована подсветка синтаксиса для CODE-чанков
- Добавлены "хлебные крошки" контекста
- Стилизация с цветовой кодировкой типов
```
