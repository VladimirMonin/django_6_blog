# Фаза 2.2: Полная русификация приложения

## Цель

Перевести все текстовые элементы приложения на русский язык: админ-панель, модели, поля, названия приложений.

## Контекст

Django поддерживает интернационализацию (i18n) из коробки. Для русификации приложения нужно:

- Изменить глобальную локаль в настройках
- Добавить `verbose_name` и `verbose_name_plural` для моделей
- Добавить `verbose_name` для всех полей модели
- Настроить русские названия приложений через `AppConfig`
- Обновить заголовки и метки в админке

**Философия:** Простая русификация через встроенные механизмы Django, без использования django-modeltranslation или gettext (это для мультиязычных сайтов).

## Задачи

### 1. Изменение глобальной локали

- [ ] Открыть `config/settings.py`
- [ ] Изменить `LANGUAGE_CODE` с `"en-us"` на `"ru-ru"`
- [ ] Изменить `TIME_ZONE` с `"UTC"` на `"Europe/Moscow"` (или оставить UTC)
- [ ] Убедиться, что `USE_I18N = True` и `USE_TZ = True` установлены
- [ ] Перезапустить сервер для применения изменений

### 2. Русификация модели Post

- [ ] Открыть `blog/models.py`
- [ ] Добавить `verbose_name` для каждого поля модели:
  - `title` → "Заголовок"
  - `slug` → "URL-slug"
  - `content` → "Содержимое"
  - `created_at` → "Дата создания"
  - `updated_at` → "Дата обновления"
  - `is_published` → "Опубликовано"
- [ ] Добавить `verbose_name` и `verbose_name_plural` в класс `Meta`:
  - `verbose_name = "Пост"`
  - `verbose_name_plural = "Посты"`
  - Сохранить существующий `ordering = ["-created_at"]`
- [ ] Проверить, что метод `__str__()` возвращает корректное отображение

### 3. Русификация приложения blog

- [ ] Открыть `blog/apps.py`
- [ ] Добавить атрибут `verbose_name` в класс `BlogConfig`:
  - Например: `verbose_name = "Блог"`
- [ ] Убедиться, что `name = "blog"` и `default_auto_field` остаются без изменений

### 4. Обновление админки с русскими названиями

- [ ] Открыть `blog/admin.py`
- [ ] Обновить `fieldsets` с русскими заголовками:
  - Первая группа: "Основная информация"
  - Вторая группа: "Статус публикации"
  - Третья группа: "Временные метки"
- [ ] Обновить description для custom actions (если есть):
  - "Опубликовать выбранные посты"
  - "Снять с публикации"
- [ ] Обновить description для display методов (если есть):
  - Например: `@display(description="Статус публикации")`

### 5. Настройка заголовков Unfold админки

- [ ] Открыть `config/settings.py`
- [ ] Обновить настройки `UNFOLD` для русских заголовков:
  - `"SITE_TITLE"` → "Django 6 Блог"
  - `"SITE_HEADER"` → "Панель управления блогом"
  - `"SIDEBAR"` → обновить названия разделов на русский
  - Навигация "Главная", "Админка", "Посты"
  - Заголовки групп: "Навигация", "Блог"

### 6. Проверка автоматической русификации Django

- [ ] Запустить сервер и открыть админку
- [ ] Убедиться, что стандартные элементы Django переведены:
  - Кнопки "Сохранить", "Сохранить и продолжить редактирование"
  - "Удалить", "История", "Просмотр на сайте"
  - Фильтры: "Все", "Да", "Нет"
  - Пагинация и счетчики
- [ ] Если переводы не применились, проверить установку русской локали в системе

### 7. Тестирование русификации

- [ ] Создать новый пост через админку:
  - Проверить, что все поля имеют русские названия
  - Проверить, что fieldsets отображаются на русском
  - Проверить, что сообщения об ошибках на русском
- [ ] Открыть список постов:
  - Проверить заголовки колонок (list_display)
  - Проверить фильтры на русском языке
  - Проверить действия (actions) на русском
- [ ] Проверить History (История изменений):
  - Убедиться, что записи на русском
  - Даты в русском формате

### 8. Обновление help_text для полей (опционально)

- [ ] Добавить `help_text` для полей в модели Post:
  - `slug` → "Автоматически генерируется из заголовка"
  - `content` → "Основной текст поста (поддерживает Markdown)"
  - `is_published` → "Снять галочку, чтобы скрыть пост с сайта"
- [ ] Проверить отображение подсказок в админке

### 9. Русификация валидационных сообщений (опционально)

- [ ] Добавить кастомные сообщения об ошибках для полей:
  - Например, для `title`: `error_messages={"unique": "Пост с таким заголовком уже существует"}`
  - Для `slug`: `error_messages={"unique": "Этот URL-slug уже используется"}`
- [ ] Проверить отображение ошибок при попытке создать дубликат

### 10. Обновление management команд (опционально)

- [ ] Открыть `blog/management/commands/create_posts.py`
- [ ] Обновить help текст команды на русский
- [ ] Обновить сообщения `self.stdout.write()` на русский
- [ ] Проверить команду:
  - `python manage.py create_posts --help`
  - Убедиться, что описание на русском

## Результат

Полностью русифицированное приложение:

- Админка отображается на русском языке
- Все модели и поля имеют русские названия
- Приложение "Blog" называется "Блог"
- Сообщения, кнопки, фильтры на русском
- Даты отображаются в русском формате

## Следующий шаг

Фаза 2.3: Markdown → HTML конвертация

## Возможные проблемы и решения

### Проблема 1: Админка остается на английском

**Причина:** Django не установлен с русскими переводами.

**Решение:**

- Проверить, что `django` установлен с локализацией
- Переустановить Django через Poetry
- Убедиться, что `LANGUAGE_CODE = "ru-ru"` в settings.py

### Проблема 2: Некоторые элементы на английском

**Причина:** Не все элементы переводятся автоматически.

**Решение:**

- Добавить `verbose_name` вручную для всех полей
- Проверить Unfold настройки (некоторые элементы нужно переводить в конфиге)
- Использовать django-admin-interface для дополнительной кастомизации (опционально)

### Проблема 3: Неправильный формат дат

**Причина:** TIME_ZONE или USE_L10N настроены некорректно.

**Решение:**

- Убедиться, что `USE_L10N = True` (устарело в Django 4+, но проверить)
- Проверить `TIME_ZONE = "Europe/Moscow"` или `"UTC"`
- Перезапустить сервер

### Проблема 4: Help_text не отображается

**Причина:** Unfold может скрывать help_text по умолчанию.

**Решение:**

- Проверить настройки Unfold
- Использовать custom виджеты для отображения подсказок
- Добавить help_text в fieldsets description (альтернативный способ)

## Проверочный чеклист

После завершения фазы убедитесь:

- [ ] Открыли админку и видите русский интерфейс
- [ ] Модель Post называется "Посты" в навигации
- [ ] Все поля модели имеют русские названия
- [ ] Кнопки "Сохранить", "Удалить" на русском
- [ ] Фильтры отображаются на русском
- [ ] Сообщения об успехе/ошибках на русском
- [ ] Даты в русском формате (дд.мм.гггг или в соответствии с локалью)
- [ ] Приложение называется "Блог" в Unfold sidebar

## Дополнительная информация

### Формат русских дат

Django автоматически использует формат дат для выбранной локали:

- Полный: `14 декабря 2025 г., 15:30`
- Короткий: `14.12.2025`

Если нужен кастомный формат, можно настроить через `DATE_FORMAT` и `DATETIME_FORMAT` в settings.py.

### Плюрализация в русском

Django корректно обрабатывает русскую плюрализацию:

- 1 пост
- 2 поста
- 5 постов

Это работает автоматически через `verbose_name_plural`.
